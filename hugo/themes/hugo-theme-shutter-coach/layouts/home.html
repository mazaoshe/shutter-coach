{{ define "main" }}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="text-center mb-12">
        <h2 class="text-4xl font-bold text-gray-900 mb-4">Perfect Camera Settings, <span class="text-blue-600">Every
                Time</span></h2>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto">Get instant camera setting recommendations based on
            your scene, weather conditions, and time of day. Perfect for beginners and hobbyists who want
            professional results.</p>
    </div>

    <div class="grid lg:grid-cols-3 gap-8">
        <div class="lg:col-span-2 space-y-8">
            {{ partial "priority-mode.html" . }}
            {{ partial "scene.html" . }}

            <div class="grid md:grid-cols-2 gap-6">
                {{ partial "weather-conditions.html" . }}
                {{ partial "time-of-day.html" . }}
            </div>
        </div>
        <div class="space-y-6">
            {{ partial "recommended-settings.html" . }}
        </div>
    </div>
    <div class="mt-16 grid md:grid-cols-3 gap-8">
        {{ partial "features.html" . }}
    </div>
</div>

{{ $weatherJS := resources.Get "js/weather.js" }}
<script src="{{ $weatherJS.RelPermalink }}"></script>

{{ $initDataJS := resources.Get "js/initData.js" }}
<script src="{{ $initDataJS.RelPermalink }}" defer></script>

{{ $initDataJS := resources.Get "js/cameraCalculator.js" }}
<script type="module" src="{{ $initDataJS.RelPermalink }}"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        function setSettings (setting) {
            document.getElementById('iso-value').textContent = setting.iso;
            document.getElementById('aperture-value').textContent = setting.aperture;
            document.getElementById('shutter-speed-value').textContent = setting.shutterSpeed;
            document.getElementById('focus-mode-value').textContent = setting.focusMode;
            document.getElementById('metering-mode-value').textContent = setting.meteringMode;

            if (setting.exposureCompensation !== undefined) {
                const ecElement = document.getElementById('exposure-compensation-value');
                if (ecElement) {
                    ecElement.textContent = setting.exposureCompensation;
                    ecElement.closest('.hidden')?.classList.remove('hidden');
                }
            }
        }

        function updateCameraSettings () {
            debugger;
            const selectedScene = window.selectedScene;
            const weather = window.weather;
            const timeOfDay = window.timeOfDay;
            const ev = window.ev;
            const priorityMode = window.priorityMode;

            if (typeof calculateCameraSettings === 'function') {
                const setting = calculateCameraSettings(selectedScene, weather, timeOfDay, ev, priorityMode);
                setSettings(setting);
                if (typeof setCameraSettings === 'function') setCameraSettings(setting);
            }
        }

        ['selectedScene', 'weather', 'timeOfDay', 'ev', 'priorityMode'].forEach(function (key) {
            document.addEventListener(key + 'Changed', updateCameraSettings);
        });

        updateCameraSettings();
    });
</script>
{{ end }}